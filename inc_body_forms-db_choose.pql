PROCEDURE      INC_BODY_FORMS.DB_CHOOSE:T  (157542,78533)  |Last amended Feb 13, 2014,21:48:53
retrieval crwarn
CALL WPF.SYSTEM.DEFINE_VARS
CALL WPF.SYSTEM.INI_VARS
CALL WPF.INC_ELEMENTS.HEADER_START
CALL WPF.INC_ELEMENTS.JAVASCRIPT
CALL WPF.INC_ELEMENTS.HEADER_END
CALL WPF.INC_ELEMENTS.BODY_START
CALL WPF.INC_ELEMENTS.BODY_END
CALL WPF.INC_ELEMENTS.STATUS_BLOCK
CALL WPF.INC_ELEMENTS.BODY_HEADER

COUNTS__4 = 0
write(cgi) '<h3 class="text-center">Welcome.</h3>'
write(cgi) '<div class="row">'
write(cgi) '<div class="span6 offset3 text-center">'
write(cgi) '<form class="center" name="dbchoose" action="<mycgi>" method="post">'
write(cgi) '<input type="hidden" name="redirect" value="<REDIRECT>">'
write(cgi) '<input type="hidden" name="member" value="WPF.CONTROLLER.FIRST_PAGE">'
write(cgi) '<p class="text-center"><strong>Choose a Database</strong></p>'
write(cgi) '<select name="dbpick" size="10" id="dblist">'
GOON__4 = 0
. ifthen(sglobal('GUSER_NAME') eq 'Greg Neils')
.   process rec DB_INFO
.     STR$1 = '<option value = "'  + trimlr(WEB_DB_NAME) + '">' + trimlr(WEB_DB_NAME) +  '</OPTION>'  | user trimlr since case ids are always padded
.     write(cgi) STR$1
.   end rec
. else
.   process rec DB_USERS
WRITE USER_NAME ':<GUSER_NAME>:'
.     ifNOT (sglobal('GUSER_NAME') eq USER_NAME) NEXT REC
.     COUNTS__4 = COUNTS__4 +1
.     STR$1 = '<option value = "'  + trimlr(WEB_DB_NAME) + '"'
.     if(COUNTS__4 = 1) STR$1 = STR$1 + ' selected ="selected"'
.     STR$1 = STR$1 + '>' + trimlr(WEB_DB_NAME) +  '</OPTION>'  | user trimlr since case ids are always padded
.     write(cgi) STR$1
.   end rec
. endif
write(cgi) '</select>'
write(cgi) '<br><input type="submit" name="submit" value="Connect DB" class="btn btn-primary"><br>'
write(cgi) '</form>'
write(cgi) '</div>'

CALL WPF.INC_ELEMENTS.SOME_MESSAGE

CALL WPF.JS.SESSION_COOKIES
CALL WPF.INC_ELEMENTS.FOOTER

END RETRIEVAL
END PROCEDURE
